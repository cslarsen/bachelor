\section{Capabilities in OpenFlow}
\label{chapter:details.openflow}

\todo{Show ONLY openflow 1.3, possibly 1.4}

To see how we can enable Paxos functionality in OpenFlow, we need to take a
look at what features it can provide us.  There are several versions of the
OpenFlow specification, so we'll review the differences in each
one.\footnote{Unfortunately, the most widely supported version of OpenFlow in
simulators and controllers seem to be OpenFlow version 1.0.}

Naturally, we could implement the whole Paxos algorithm in the controller
itself.  Doing so should be quite trivial: One could modify an existing
implementation and make it use OpenFlow to transmit packages between
switches.  However, that would be very inefficient compared to running the
entire algorithm, or parts of it, on the switch.

Prior to OpenFlow 1.0 \cite{openflow-1.0} there were several working
drafts not meant for implementation.  We will not look at these prior
versions.

In the tables below, you can see what version 1.0 offers in terms of core
functionality.  Some details have been omitted in favour of giving a clear
overview.  For details, see the full specification \cite{openflow-1.0}.

What's most important in 1.0, compared to later versions, is that it only
has \textit{one} flow table and only supports IPv4.  Other than that it has
counters per table, per flow, per port and per queue.  The headers that can
be used for matching packets are listed in table
\ref{table:openflow-1.0.headers} \vpageref{table:openflow-1.0.headers} and
the actions in table \ref{table:openflow-1.0.actions}
\vpageref{table:openflow-1.0.actions}.

By \textit{transport} address and port, we mean \acs{TCP} or \acs{UDP},
depending on what packet is currently matched\index{OpenFlow!transport}.

The specification requires compliant switches to update packet checksums
when modifying fields that require it.

\begin{table}
  \centering
  \begin{tabular}{l}
    \hline
     \textbf{Header-field} \\
    \hline
     Ingress port\index{OpenFlow!match on ingress port} \\

     Ethernet source address\index{OpenFlow!match on Ethernet} \\
     Ethernet destination address\index{OpenFlow!match on Ethernet} \\

     VLAN ID\index{OpenFlow!match on VLAN} \\
     VLAN priority\index{OpenFlow!match on VLAN} \\

     IP source address\index{OpenFlow!match on IP address} \\
     IP destination address\index{OpenFlow!match on IP address} \\
     IP protocol\index{OpenFlow!match on IP protocol} \\
     IP \ac{ToS} bits\index{OpenFlow!match on ToS} \\

     Transport source port\index{OpenFlow!UDP}\index{OpenFlow!TCP}\index{OpenFlow!transport} \\
     Transport destination port \\
    \hline
  \end{tabular}
  \caption{Header-fields that can be matched in OpenFlow 1.0.}
  \label{table:openflow-1.0.headers}
\end{table}
\index{OpenFlow!matching}
\index{OpenFlow!header-fields}
\index{OpenFlow!matching header-fields}

\begin{table}
  \centering
  \begin{tabular}{lll}
    \hline
      \textbf{Action} &
      \textbf{Required} &
      \textbf{Options} \\

    \hline
      Forward\index{OpenFlow!forwarding action} &
      Required &
               To all \\
     & & To controller \\
     & & To local switch \\
     & & To flow table \\
     & & To port \\
    \\
      Forward\index{OpenFlow!forwarding action} &
      Optional &
               Normal \\
     & & Flood\index{OpenFlow!flooding action} \\
    \\
      Enqueue\index{OpenFlow!enqueue action} &
      Optional &
      Can be used to implement, e.g., \acs{QoS}\index{OpenFlow!QoS} \\
    \\
      Drop\index{OpenFlow!drop action} &
      Required &
      Drop packet \\
    \\
      Modify-field\index{OpenFlow!modify-field action} &
      Optional &
               Set or replace VLAN ID\index{OpenFlow!modify VLAN} \\
     & & Set or replace VLAN priority\index{OpenFlow!modify VLAN} \\
     & & Strip any VLAN header\index{OpenFlow!modify VLAN} \\
     & & Replace Ethernet source address\index{OpenFlow!modify Ethernet addresses} \\
     & & Replace Ethernet destination address \\
     & & Replace IPv4 source address\index{OpenFlow!modify IPv4 addresses} \\
     & & Replace IPv4 destination address\index{OpenFlow!modify IPv4 addresses} \\
     & & Replace IPv4 \acs{ToS} bits\index{OpenFlow!modify ToS bits} \\
     & & Replace transport source port\index{OpenFlow!modify transport ports} \\
     & & Replace transport destination port\index{OpenFlow!modify transport ports} \\
    \hline
  \end{tabular}
  \caption{Actions in OpenFlow 1.0.}
  \label{table:openflow-1.0.actions}
\end{table}
\index{OpenFlow!actions}

\todo{Skriv litt mer om features i openflow-versjoner nyere enn 1.0, ikke
  lag tabeller, bare list opp store forskjeller. Bruk dette i
    argumentasjonen under.}
