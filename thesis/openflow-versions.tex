\section{Capabilities in OpenFlow}
\label{chapter:details.openflow}

\todo{Show ONLY openflow 1.3, possibly 1.4}

To see how we can enable Paxos functionality in OpenFlow, we need to take a
look at what features it can provide us.  There are several versions of the
OpenFlow specification, so we'll review the differences in each
one\footnote{Unfortunately, the most widely supported version of OpenFlow in
simulators and controllers seem to be OpenFlow version 1.0.}

Naturally, we could implement the whole Paxos algorithm in the controller
itself.  Doing so should be quite trivial: One could modify an existing
implementation and make it use OpenFlow to transmit packages between
switches.  However, that would be very inefficient compared to running the
entire algorithm, or parts of it, on the switch.

Prior to OpenFlow 1.0 \cite{openflow-1.0} there were several working
drafts not meant for implementation.  We will not look at these prior
versions.

In the tables below, you can see what version 1.0 offers in terms of core
functionality.  Some details have been omitted in favour of giving a clear
overview.  For details, see the full specification \cite{openflow-1.0}.

What's most important in 1.0, compared to later versions, is that it only
has {\em one} flow table and only supports IPv4.  Other than that it has
counters per table, per flow, per port and per queue.  The headers that can
be used for \textbf{matching packets} are listed in table
\ref{table:openflow-1.0.headers}, the \textbf{actions} in table
\ref{table:openflow-1.0.actions} and the {\em optional} \textbf{modifiable
  fields} in table \ref{table:openflow-1.0.mods}

The specification requires compliant switches to update packet checksums
when modifying fields that require it.

\begin{table}
\centering
  \begin{tabular}{|l|}
    \hline \textbf{Header--field for matching} \\
    \hline Ingress port \\
    \hline Ethernet source address \\
    \hline Ethernet destination address \\
    \hline VLAN ID \\
    \hline VLAN priority \\
    \hline IP source address \\
    \hline IP destination address \\
    \hline IP protocol \\
    \hline IP \ac{ToS} bits \\
    \hline Transport (TCP or UDP) source port \\
    \hline Transport (TCP or UDP) destination port \\
    \hline
  \end{tabular}
  \caption{Header--fields to match on in OpenFlow 1.0.}
  \label{table:openflow-1.0.headers}
\end{table}

\begin{table}
\centering
  \begin{tabular}{|l|l|l|}
    \hline \textbf{Action} &
           \textbf{Required} &
           \textbf{Comment} \\
    \hline Forward & Required & To all, controller, local switch, table and input--port \\
    \hline Forward & Optional & Normal, flood \\
    \hline Enqueue & Optional &  Can be used to implement \ac{QoS} \\
    \hline Drop    & Required &  Drops matched packet \\
    \hline Modify--field & Optional &  See table \ref{table:openflow-1.0.mods} \\
    \hline
  \end{tabular}
  \caption{Actions in OpenFlow 1.0.}
  \label{table:openflow-1.0.actions}
\end{table}

\begin{table}
\centering
  \begin{tabular}{|l|l|}
    \hline \textbf{Action} \\
    \hline Set or replace VLAN ID \\
    \hline Set or replace VLAN priority \\
    \hline Strip any VLAN header \\
    \hline Replace Ethernet source MAC address \\
    \hline Replace Ethernet destination MAC address \\
    \hline Replace IPv4 source address \\
    \hline Replace IPv4 destination address \\
    \hline Replace IPv4 \ac{ToS} bits \\
    \hline Replace transport (TCP or UDP) source port \\
    \hline Replace transport (TCP or UDP) destination port \\
    \hline
  \end{tabular}
  \caption{Optional {\em Modify--field} actions in OpenFlow 1.0.}
  \label{table:openflow-1.0.mods}
\end{table}

\todo{Skriv litt mer om features i openflow--versjoner nyere enn 1.0, ikke
  lag tabeller, bare list opp store forskjeller. Bruk dette i
    argumentasjonen under.}
